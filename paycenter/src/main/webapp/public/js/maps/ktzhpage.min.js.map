{"version":3,"sources":["ktzhpage.min.js"],"names":["prepare","fee","ctx","oid","showLoading","msg","layer","icon","shade","reset","$","hide","text","price","checkDiscountCode","code","callback","ajax","type","url","success","data","show","parseInt","lastConfirmed","call","trim","checkSendTime","time","mobileConfirmed","elGetCode","off","on","getMobileCode","setTimeout","toRegister","focus","onRegistValidationOK","vcode","val","discountCode","tradeNo","openid","login","password","passwordConfirmation","company","mobile","items","eq","removeClass","addClass","attr","css","checkRegister","index","serialize","error","complete","close","onPayedSuccess","window","location","onPayCancelled","test","idx","load","dataType","smsUrl","register","validRes","validate","rules","required","minlength","params","custom","back","is","onBridgeReady","WeixinJSBridge","invoke","packages","res","err_msg","doPay","document","addEventListener","attachEvent","prePay","payEntry","lastDiscountCode","keyup","this","length","click"],"mappings":"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","file":"../ktzhpage.min.js","sourcesContent":["function toRegister(){$(\".ktzhpage\").hide(),$(\".zhxxpage\").show(),$('input[name=\"login\"]').focus()}function register(){var e=$(\".zhxxpage input\").validate({rules:{login:{required:\"请输入登录账号\",minlength:{msg:\"登录账号长度不得少于4位\",params:4},custom:{params:function(e){return/^[0-9a-zA-Z]*[0-9][0-9a-zA-Z]*$/.test(e)&&/^[0-9a-zA-Z]*[a-zA-Z][0-9a-zA-Z]*$/.test(e)},msg:\"登录账号应为字母和数字的组合\"}},password:{required:\"请输入密码\",minlength:{msg:\"密码不得少于6位\",params:6}},passwordConfirmation:{required:\"请输入确认密码\",custom:{params:function(e){return e==$('input[name=\"password\"]').val()},msg:\"两次输入的密码不一致\"}},company:{required:\"请输入企业名称\",custom:{params:function(e){return/^[\\u4e00-\\u9fa5]{4,}$/.test(e)},msg:\"企业名称应为4个及以上汉字\"}},mobile:{required:\"请输入手机号\",mobile:\"手机格式不正确\"},code:{required:\"请输入验证码\",custom:{params:function(e){var t=$(\"input[name='vcode']\").val();return!!$.trim(t)&&!($.trim(e)&&$.trim(t)&&t!=e)},msg:\"验证码错误\"}}}});e&&checkRegister(onRegistValidationOK)}function back(e){$(\".ktzhpage\").is(\":hidden\")?($(\".ktzhpage\").show(),$(\".zhxxpage\").hide()):window.location=\"${ctx}/toLogin/\"+e}function prepareKt(e,t,n){function a(e){return layer.msg(e,{icon:16,shade:.3})}function o(){$(\".icon-error\").hide(),$(\".discount-amount\").hide(),$(\".icon-right\").hide(),$(\"#discount-span\").text(\"0\"),$(\".fc-fd1520-span\").text(x)}function i(e,n){$.ajax({type:\"post\",url:t+\"/checkDiscountCode/\"+e,success:function(t){200==t.code?($(\".icon-error\").hide(),$(\".discount-amount\").show(),$(\".icon-right\").show(),$(\"#discount-span\").text(t.data),$(\".fc-fd1520-span\").text(parseInt(x)-parseInt(t.data)),n&&(v.discountCode=e,n.call())):400==t.code&&($.trim(e)&&$(\".icon-error\").show(),$(\".discount-amount\").hide(),$(\".icon-right\").hide(),n&&(v.discountCode=\"@0\",n.call()))}})}function r(e){e<=1?(_||f.off(\"click\").on(\"click\",u),f.text(\"获取验证码\")):(f.off(\"click\"),e-=1,f.text(\"重新获取(\"+e+\")\"),setTimeout(function(){r(e)},1e3))}function c(){$.ajax({type:\"post\",url:t+\"/sfpay/pay\",data:v,success:function(){window.location=t+\"/toLogin/\"+n},error:function(){layer.msg(\"系统忙，请稍后再试\")},complete:function(){}})}function s(){$.ajax({type:\"post\",url:t+\"/sfpay/cancel/\"+h,success:function(){window.location=t+\"/toLogin/\"+n},error:function(){}})}function u(){var e=$('input[name=\"mobile\"]').val();if(!$.trim(e))return void layer.msg(\"请输入有效的手机号\");if(!/^1\\d{10}$/.test(e))return void layer.msg(\"手机号格式不正确\");var n=t+\"/checkMobile/\"+e,a=layer.load(0,{shade:!1});$.ajax({dataType:\"json\",type:\"POST\",data:{mobile:e},url:n,success:function(n){if(200==n.code){r(60);var a=t+\"/sms\";$.ajax({dataType:\"json\",type:\"POST\",data:{mobile:e},url:a,success:function(e){if(200==e.code){var t=e.data;$('input[name=\"vcode\"]').val(t)}}})}else 422==n.code&&layer.msg(\"手机号已被占用\")},complete:function(){layer.close(a)}})}function d(){WeixinJSBridge.invoke(\"getBrandWCPayRequest\",y,function(e){\"get_brand_wcpay_request：ok\"==e.err_msg||\"get_brand_wcpay_request:ok\"==e.err_msg?(layer.msg(\"支付成功\"),$(\"#btn_pay\").off(\"click\"),c()):\"get_brand_wcpay_request：cancel\"==e.err_msg||\"get_brand_wcpay_request:cancel\"==e.err_msg?s():\"get_brand_wcpay_request：fail\"!=e.err_msg&&\"get_brand_wcpay_request:fail\"!=e.err_msg||s()})}function l(e){y=e.data.packages,h=e.data.tradeNo,$(\"input[name='tradeNo']\").val(h),v.tradeNo=h,\"undefined\"==typeof WeixinJSBridge?document.addEventListener?document.addEventListener(\"WeixinJSBridgeReady\",d,!1):document.attachEvent?(document.attachEvent(\"WeixinJSBridgeReady\",d),document.attachEvent(\"onWeixinJSBridgeReady\",d)):d():d()}function m(){var e=a(\"下单中\");$.ajax({type:\"post\",url:t+\"/sfpay/prepay/\"+n,dataType:\"json\",data:v,success:function(e){var t=e.code;422==t?layer.msg(\"请勿重复提交订单\"):423==t?layer.msg(\"登录账号已被占用\"):424==t?($('input[name=\"mobile\"]').attr(\"readonly\",!1).removeClass(\"text-readonly\"),$('input[name=\"code\"]').attr(\"readonly\",!1).removeClass(\"text-readonly\"),f.off(\"click\").on(\"click\",u),layer.msg(\"手机号已被占用\")):426==t||425==t?(layer.msg(\"下单失败\"),$(\"#btn_pay\").on(\"click\",p)):200==t?l(e):layer.msg(\"系统繁忙，请稍后再试。\")},error:function(){layer.msg(\"系统繁忙，请稍后再试。\"),$(\"#btn_pay\").on(\"click\",p)},complete:function(){layer.close(e)}})}function p(){_?($(\"#btn_pay\").off(\"click\"),i($(\"#input-yhm\").val(),function(){m()})):layer.msg(\"请完善个人信息\")}var f,g,y,h,v,_=!1,x=e;$(function(){f=$(\"#smsCode\"),f.on(\"click\",function(){u()}),$(\"#input-yhm\").keyup(function(){var e=$(this).val();e.length<4?o():e.length>=4&&e!=g&&($('input[name=\"discountCode\"]').val($.trim(e)),i($.trim(e))),g=e})}),$(\"#btn_pay\").on(\"click\",p)}\n//# sourceMappingURL=maps/ktzhpage.min.js.map\n"]}